using NuGetDefense.OSSIndex;
using Scanner = NuGetDefense.NVD.Scanner;

namespace NuGetDefense
{
    public class Vulnerability
    {
        public string Cve;
        public double CvssScore;
        public string Cwe;
        public string Description;
        public string Vector;
        public string Vendor;

        public Vulnerability(ComponentReportVulnerability vulnerability)
        {
            Cve = vulnerability.Cve;
            Description = vulnerability.Description;
            Cwe = vulnerability.Cwe;
            Vendor = "";
            CvssScore = vulnerability.CvssScore;
            Vector = vulnerability.CvssVector;
        }

        public Vulnerability(string cve,
            (string[] versions, string description, string cwe, string vendor, double? score, Scanner.AccessVectorType
                vector) vulnerability)
        {
            Cve = cve;
            Description = vulnerability.description;
            Cwe = vulnerability.cwe;
            Vendor = vulnerability.vendor;
            CvssScore = vulnerability.score ?? -1;
            Vector = vulnerability.vector.ToString();
        }
    }
}