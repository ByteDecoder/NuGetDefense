using System;
using System.Xml.Serialization;

namespace NuGetDefense;

public class VulnerabilityReport
{
    [XmlAttribute] public int VulnerabilitiesCount { get; set; }

    public VulnerableNuGetPackage[] Packages { get; set; } = Array.Empty<VulnerableNuGetPackage>();
}

public class VulnerableNuGetPackage
{
    [XmlAttribute] public string? Id { get; set; }

    public string PackageUrl => $"pkg:nuget/{Id}@{Version}";
    [XmlAttribute] public string? Version { get; set; }

    public ReportedVulnerability[] Vulnerabilities { get; set; } = Array.Empty<ReportedVulnerability>();
}

public class ReportedVulnerability
{
    [XmlAttribute] public string? Description { get; set; }

    [XmlAttribute] public string? Cve { get; set; }

    [XmlAttribute] public string? Cwe { get; set; }

    [XmlAttribute] public double CvssScore { get; set; }

    [XmlAttribute] public string? CvssVector { get; set; }
}